<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Feed My Brain</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#4f46e5",
              secondary: "#6366f1",
            },
            borderRadius: {
              none: "0px",
              sm: "4px",
              DEFAULT: "8px",
              md: "12px",
              lg: "16px",
              xl: "20px",
              "2xl": "24px",
              "3xl": "32px",
              full: "9999px",
              button: "8px",
            },
          },
        },
      };
    </script>
    <style>
      :where([class^="ri-"])::before { content: "\f3c2"; }

      body {
          font-family: 'Inter', sans-serif;
          background-color: #f9fafb;
      }

      .toast {
          position: fixed;
          top: 1rem;
          right: 1rem;
          padding: 0.75rem 1.5rem;
          background-color: white;
          border-radius: 8px;
          box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
          z-index: 50;
          transform: translateY(-100%);
          opacity: 0;
          transition: transform 0.3s ease-out, opacity 0.3s ease-out;
      }

      .toast.show {
          transform: translateY(0);
          opacity: 1;
      }

      .modal {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.5);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 40;
          opacity: 0;
          pointer-events: none;
          transition: opacity 0.3s ease;
      }

      .modal.show {
          opacity: 1;
          pointer-events: auto;
      }

      .modal-content {
          background-color: white;
          border-radius: 8px;
          width: 90%;
          max-width: 800px;
          max-height: 90vh;
          overflow: hidden;
          transform: scale(0.9);
          transition: transform 0.3s ease;
      }

      .modal.show .modal-content {
          transform: scale(1);
      }

      .custom-checkbox {
          position: relative;
          display: inline-block;
          width: 20px;
          height: 20px;
          border: 2px solid #d1d5db;
          border-radius: 4px;
          transition: all 0.2s ease;
      }

      .custom-checkbox.checked {
          background-color: #4f46e5;
          border-color: #4f46e5;
      }

      .custom-checkbox.checked::after {
          content: '';
          position: absolute;
          top: 3px;
          left: 6px;
          width: 6px;
          height: 10px;
          border: solid white;
          border-width: 0 2px 2px 0;
          transform: rotate(45deg);
      }

      .toggle-switch {
          position: relative;
          display: inline-block;
          width: 44px;
          height: 24px;
      }

      .toggle-switch input {
          opacity: 0;
          width: 0;
          height: 0;
      }

      .toggle-slider {
          position: absolute;
          cursor: pointer;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background-color: #e5e7eb;
          transition: .4s;
          border-radius: 24px;
      }

      .toggle-slider:before {
          position: absolute;
          content: "";
          height: 18px;
          width: 18px;
          left: 3px;
          bottom: 3px;
          background-color: white;
          transition: .4s;
          border-radius: 50%;
      }

      input:checked + .toggle-slider {
          background-color: #4f46e5;
      }

      input:checked + .toggle-slider:before {
          transform: translateX(20px);
      }

      .feed-item {
          transition: background-color 0.2s ease;
      }

      .feed-item:hover {
          background-color: #f3f4f6;
      }

      .video-card {
          transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      .video-card:hover {
          transform: translateY(-2px);
          box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }

      /* Hide number input arrows */
      input[type=number]::-webkit-inner-spin-button,
      input[type=number]::-webkit-outer-spin-button {
          -webkit-appearance: none;
          margin: 0;
      }
      input[type=number] {
          -moz-appearance: textfield;
      }

      @media (max-width: 768px) {
          .main-container {
              flex-direction: column;
          }

          .left-column, .right-column {
              width: 100%;
          }
      }
    </style>
  </head>
  <body class="min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
      <header class="mb-8">
        <div class="flex items-center justify-between">
          <h1 class="text-3xl font-['Pacifico'] text-primary">Feed My Brain</h1>
          <div class="flex items-center space-x-4">
            <label class="toggle-switch">
              <input type="checkbox" id="darkModeToggle" />
              <span class="toggle-slider"></span>
            </label>
            <span class="text-sm text-gray-600">Dark Mode</span>
          </div>
        </div>
      </header>

      <div class="main-container flex gap-6">
        <!-- Left Column -->
        <div class="left-column w-1/3 min-w-[300px]">
          <!-- Profile Section -->
          <div id="profile-section" class="bg-white rounded shadow p-4 mb-6">
          </div>
          

          <!-- Feed Management -->
          <div class="bg-white rounded shadow p-4 mb-6">
            <h2 class="text-lg font-medium mb-4">Manage Feeds</h2>

            <form id="add-feed-form" class="flex mb-4">
              <input
                type="text"
                id="feed-url-input"
                placeholder="Enter feed URL"
                class="flex-1 px-3 py-2 border border-gray-300 rounded-l-button focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
              />
              <button
                class="bg-primary text-white px-4 py-2 rounded-r-button hover:bg-primary/90 transition-colors whitespace-nowrap"
                type="submit"
              >
                <i class="ri-add-line mr-1"></i> Add
              </button>
            </form>

            <div class="mt-4 max-h-[400px] overflow-y-auto">
              <div class="feed-list space-y-2">
                <!-- Feed items will be rendered here by feeds.js -->
              </div>
            </div>
          </div>

          <!-- Search/Filter -->
          <div class="bg-white rounded shadow p-4">
            <h2 class="text-lg font-medium mb-4">Search & Filter</h2>

            <div class="relative">
              <input
                type="text"
                placeholder="Search videos..."
                class="w-full pl-10 pr-3 py-2 border border-gray-300 rounded-button focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
              />
              <div
                class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4 flex items-center justify-center"
              >
                <i class="ri-search-line"></i>
              </div>
            </div>

            <div class="mt-4">
              <label class="block text-sm text-gray-600 mb-2"
                >Filter by feed:</label
              >
              <div class="relative">
                <select
                  class="w-full appearance-none bg-white border border-gray-300 rounded-button px-3 py-2 pr-8 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                >
                  <option value="">All feeds</option>
                  <option value="ted">TED Talks</option>
                  <option value="mit">MIT OpenCourseWare</option>
                  <option value="crash">Crash Course</option>
                  <option value="khan">Khan Academy</option>
                  <option value="natgeo">National Geographic</option>
                  <option value="kurzgesagt">Kurzgesagt</option>
                </select>
                <div
                  class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none w-4 h-4 flex items-center justify-center"
                >
                  <i class="ri-arrow-down-s-line"></i>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Right Column -->
        <div class="right-column flex-1">
          <!-- Tabs -->
          <div class="bg-white rounded shadow mb-6 p-1 inline-flex">
            <button
              class="px-4 py-2 rounded-full bg-primary text-white text-sm font-medium whitespace-nowrap"
            >
              New Videos
            </button>
            <button
              class="px-4 py-2 rounded-full text-gray-700 hover:bg-gray-100 text-sm font-medium whitespace-nowrap"
            >
              Saved Videos
            </button>
          </div>

          <!-- New Videos Section -->
          <div class="new-videos-section">
            <div class="flex justify-between items-center mb-4">
              <div class="flex items-center gap-4">
                <h2 class="text-xl font-medium">New Videos</h2>
                <div class="relative">
                  <button
                    id="timeFilterBtn"
                    class="flex items-center gap-2 px-3 py-1.5 text-sm text-gray-700 bg-white border border-gray-300 rounded-button hover:bg-gray-50 whitespace-nowrap"
                  >
                    <span id="selectedTimeFilter">Today</span>
                    <i class="ri-arrow-down-s-line"></i>
                  </button>
                  <div
                    id="timeFilterDropdown"
                    class="absolute left-0 mt-1 w-36 bg-white border border-gray-300 rounded shadow-lg hidden z-10"
                  >
                    <div class="py-1">
                      <button
                        class="w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 whitespace-nowrap"
                        data-value="today"
                      >
                        Today
                      </button>
                      <button
                        class="w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 whitespace-nowrap"
                        data-value="week"
                      >
                        This week
                      </button>
                      <button
                        class="w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 whitespace-nowrap"
                        data-value="month"
                      >
                        This month
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <button
                class="text-sm text-primary hover:text-primary/80 transition-colors whitespace-nowrap"
              >
                Mark all as watched
              </button>
            </div>

            <ul id="new" class="grid grid-cols-1 gap-4"></ul>
          </div>

          <!-- Saved Videos Section (Hidden by default) -->
          <div class="saved-videos-section hidden">
            <div class="flex justify-between items-center mb-4">
              <h2 class="text-xl font-medium">Saved Videos</h2>
              <button
                class="text-sm text-primary hover:text-primary/80 transition-colors whitespace-nowrap"
              >
                Clear all saved
              </button>
            </div>

            <ul id="saved" class="grid grid-cols-1 gap-4"></ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
      <div class="flex items-center">
        <div class="w-5 h-5 flex items-center justify-center text-primary mr-2">
          <i class="ri-check-line"></i>
        </div>
        <span id="toastMessage">Action completed successfully</span>
      </div>
    </div>

    <!-- Video Player Modal -->
    <div id="videoModal" class="modal">
      <div class="modal-content p-4">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-lg font-medium" id="videoTitle">Video Title</h3>
          <button
            id="closeModal"
            class="text-gray-500 hover:text-gray-700 transition-colors w-8 h-8 flex items-center justify-center"
          >
            <i class="ri-close-line ri-lg"></i>
          </button>
        </div>
        <div
          class="aspect-video bg-gray-100 rounded flex items-center justify-center"
        >
          <div class="text-gray-400 text-center">
            <div class="w-16 h-16 mx-auto flex items-center justify-center">
              <i class="ri-video-line ri-3x"></i>
            </div>
            <p class="mt-2">Video player would appear here</p>
          </div>
        </div>
        <div class="mt-4">
          <div class="flex items-center justify-between">
            <div>
              <h4 class="font-medium" id="videoSource">Source</h4>
              <p class="text-sm text-gray-500" id="videoDate">Date</p>
            </div>
            <div class="flex space-x-4">
              <button
                class="text-gray-500 hover:text-primary transition-colors w-8 h-8 flex items-center justify-center whitespace-nowrap"
              >
                <i class="ri-bookmark-line ri-lg"></i>
              </button>
              <button
                class="text-gray-500 hover:text-green-500 transition-colors w-8 h-8 flex items-center justify-center whitespace-nowrap"
              >
                <i class="ri-check-double-line ri-lg"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Delete Confirmation Dialog -->
    <div id="deleteDialog" class="modal">
      <div class="modal-content p-4 max-w-md">
        <h3 class="text-lg font-medium mb-2">Confirm Deletion</h3>
        <p class="text-gray-600 mb-4">
          Are you sure you want to delete this feed? All associated videos will
          be removed from your lists.
        </p>
        <div class="flex justify-end space-x-3">
          <button
            id="cancelDelete"
            class="px-4 py-2 border border-gray-300 rounded-button text-gray-700 hover:bg-gray-50 transition-colors whitespace-nowrap"
          >
            Cancel
          </button>
          <button
            id="confirmDelete"
            class="px-4 py-2 bg-red-500 text-white rounded-button hover:bg-red-600 transition-colors whitespace-nowrap"
          >
            Delete
          </button>
        </div>
      </div>
    </div>

    <script id="toastHandler">
      document.addEventListener("DOMContentLoaded", function () {
        const toast = document.getElementById("toast");
        const toastMessage = document.getElementById("toastMessage");

        window.showToast = function (message, duration = 3000) {
          toastMessage.textContent = message;
          toast.classList.add("show");

          setTimeout(() => {
            toast.classList.remove("show");
          }, duration);
        };
      });
    </script>

    <script id="tabSwitcher">
      document.addEventListener("DOMContentLoaded", function () {
        const newVideosTab = document.querySelector(
          ".bg-white.rounded.shadow.mb-6.p-1 button:first-child",
        );
        const savedVideosTab = document.querySelector(
          ".bg-white.rounded.shadow.mb-6.p-1 button:last-child",
        );
        const newVideosSection = document.querySelector(".new-videos-section");
        const savedVideosSection = document.querySelector(".saved-videos-section");

        newVideosTab.addEventListener("click", function () {
          newVideosTab.classList.add("bg-primary", "text-white");
          newVideosTab.classList.remove("text-gray-700", "hover:bg-gray-100");

          savedVideosTab.classList.remove("bg-primary", "text-white");
          savedVideosTab.classList.add("text-gray-700", "hover:bg-gray-100");

          newVideosSection.classList.remove("hidden");
          savedVideosSection.classList.add("hidden");
        });

        savedVideosTab.addEventListener("click", function () {
          savedVideosTab.classList.add("bg-primary", "text-white");
          savedVideosTab.classList.remove("text-gray-700", "hover:bg-gray-100");

          newVideosTab.classList.remove("bg-primary", "text-white");
          newVideosTab.classList.add("text-gray-700", "hover:bg-gray-100");

          savedVideosSection.classList.remove("hidden");
          newVideosSection.classList.add("hidden");
        });
      });
    </script>

    <script id="videoModalHandler">
      document.addEventListener("DOMContentLoaded", function () {
        const videoModal = document.getElementById("videoModal");
        const closeModal = document.getElementById("closeModal");
        const videoTitle = document.getElementById("videoTitle");
        const videoSource = document.getElementById("videoSource");
        const videoDate = document.getElementById("videoDate");
        const playButtons = document.querySelectorAll(".ri-play-circle-line");

        // Open modal when play button is clicked
        playButtons.forEach((button) => {
          button.closest("button").addEventListener("click", function () {
            const card = this.closest(".video-card");
            const title = card.querySelector("h3").textContent;
            const source = card.querySelector(
              ".text-gray-500 span:first-child",
            ).textContent;
            const date = card.querySelector(
              ".text-gray-500 span:last-child",
            ).textContent;

            videoTitle.textContent = title;
            videoSource.textContent = source;
            videoDate.textContent = date;

            videoModal.classList.add("show");
          });
        });

        // Close modal
        closeModal.addEventListener("click", function () {
          videoModal.classList.remove("show");
        });

        // Close modal when clicking outside
        videoModal.addEventListener("click", function (e) {
          if (e.target === videoModal) {
            videoModal.classList.remove("show");
          }
        });
      });
    </script>

    <script id="deleteDialogHandler">
      document.addEventListener("DOMContentLoaded", function () {
        const deleteDialog = document.getElementById("deleteDialog");
        const cancelDelete = document.getElementById("cancelDelete");
        const confirmDelete = document.getElementById("confirmDelete");
        const deleteButtons = document.querySelectorAll(".ri-delete-bin-line");

        let feedToDelete = null;

        // Open delete dialog
        deleteButtons.forEach((button) => {
          button.closest("button").addEventListener("click", function () {
            feedToDelete = this.closest(".feed-item");
            deleteDialog.classList.add("show");
          });
        });

        // Cancel delete
        cancelDelete.addEventListener("click", function () {
          deleteDialog.classList.remove("show");
          feedToDelete = null;
        });

        // Confirm delete
        confirmDelete.addEventListener("click", function () {
          if (feedToDelete) {
            feedToDelete.remove();
            showToast("Feed deleted successfully");
          }
          deleteDialog.classList.remove("show");
          feedToDelete = null;
        });

        // Close dialog when clicking outside
        deleteDialog.addEventListener("click", function (e) {
          if (e.target === deleteDialog) {
            deleteDialog.classList.remove("show");
            feedToDelete = null;
          }
        });
      });
    </script>

    <script id="videoActionHandlers">
      document.addEventListener("DOMContentLoaded", function () {
        // Save/Unsave buttons
        const saveButtons = document.querySelectorAll(
          ".ri-bookmark-line, .ri-bookmark-fill",
        );

        saveButtons.forEach((button) => {
          button.closest("button").addEventListener("click", function () {
            const icon = this.querySelector("i");

            if (icon.classList.contains("ri-bookmark-line")) {
              icon.classList.remove("ri-bookmark-line");
              icon.classList.add("ri-bookmark-fill");
              this.classList.add("text-primary");
              this.classList.remove("text-gray-500");
              showToast("Video saved");
            } else {
              icon.classList.remove("ri-bookmark-fill");
              icon.classList.add("ri-bookmark-line");
              this.classList.remove("text-primary");
              this.classList.add("text-gray-500");
              showToast("Video unsaved");
            }
          });
        });

        // Mark watched/unwatched buttons
        const watchButtons = document.querySelectorAll(
          ".ri-check-double-line, .ri-check-double-fill",
        );

        watchButtons.forEach((button) => {
          button.closest("button").addEventListener("click", function () {
            const icon = this.querySelector("i");

            if (icon.classList.contains("ri-check-double-line")) {
              icon.classList.remove("ri-check-double-line");
              icon.classList.add("ri-check-double-fill");
              this.classList.add("text-green-500");
              this.classList.remove("text-gray-500");
              showToast("Marked as watched");
            } else {
              icon.classList.remove("ri-check-double-fill");
              icon.classList.add("ri-check-double-line");
              this.classList.remove("text-green-500");
              this.classList.add("text-gray-500");
              showToast("Marked as unwatched");
            }
          });
        });
      });
    </script>

    

    <script id="darkModeToggle">
      document.addEventListener("DOMContentLoaded", function () {
        const darkModeToggle = document.getElementById("darkModeToggle");
        const html = document.documentElement;

        // Check for saved preference
        const darkMode = localStorage.getItem("darkMode") === "true";

        // Apply saved preference
        if (darkMode) {
          html.classList.add("dark");
          darkModeToggle.checked = true;
          applyDarkMode();
        }

        // Toggle dark mode
        darkModeToggle.addEventListener("change", function () {
          if (this.checked) {
            html.classList.add("dark");
            localStorage.setItem("darkMode", "true");
            applyDarkMode();
          } else {
            html.classList.remove("dark");
            localStorage.setItem("darkMode", "false");
            applyLightMode();
          }
        });

        function applyDarkMode() {
          document.body.style.backgroundColor = "#111827";
          document.body.style.color = "#f9fafb";

          // Update all white backgrounds
          document.querySelectorAll(".bg-white").forEach((el) => {
            el.classList.remove("bg-white");
            el.classList.add("bg-gray-800");
          });

          // Update text colors
          document
            .querySelectorAll(".text-gray-500, .text-gray-600, .text-gray-700")
            .forEach((el) => {
              el.classList.remove("text-gray-500", "text-gray-600", "text-gray-700");
              el.classList.add("text-gray-400");
            });

          // Update borders
          document.querySelectorAll(".border-gray-300").forEach((el) => {
            el.classList.remove("border-gray-300");
            el.classList.add("border-gray-700");
          });
        }

        function applyLightMode() {
          document.body.style.backgroundColor = "#f9fafb";
          document.body.style.color = "#111827";

          // Update all dark backgrounds
          document.querySelectorAll(".bg-gray-800").forEach((el) => {
            el.classList.remove("bg-gray-800");
            el.classList.add("bg-white");
          });

          // Update text colors
          document.querySelectorAll(".text-gray-400").forEach((el) => {
            el.classList.add("text-gray-500");
            el.classList.remove("text-gray-400");
          });

          // Update borders
          document.querySelectorAll(".border-gray-700").forEach((el) => {
            el.classList.remove("border-gray-700");
            el.classList.add("border-gray-300");
          });
        }
      });
    </script>
    <script id="timeFilterHandler">
      document.addEventListener("DOMContentLoaded", function () {
        const timeFilterBtn = document.getElementById("timeFilterBtn");
        const timeFilterDropdown = document.getElementById("timeFilterDropdown");
        const selectedTimeFilter = document.getElementById("selectedTimeFilter");
        const filterOptions = timeFilterDropdown.querySelectorAll("button");
        // Toggle dropdown
        timeFilterBtn.addEventListener("click", function (e) {
          e.stopPropagation();
          timeFilterDropdown.classList.toggle("hidden");
        });
        // Close dropdown when clicking outside
        document.addEventListener("click", function () {
          timeFilterDropdown.classList.add("hidden");
        });
        // Handle filter selection
        filterOptions.forEach((option) => {
          option.addEventListener("click", function () {
            const value = this.dataset.value;
            selectedTimeFilter.textContent = this.textContent;
            timeFilterDropdown.classList.add("hidden");
            // Filter videos based on selection
            filterVideosByTime(value);
            showToast(`Showing videos from ${this.textContent.toLowerCase()}`);
          });
        });
        function filterVideosByTime(timeFrame) {
          const today = new Date();
          const videoCards = document.querySelectorAll(
            ".new-videos-section .video-card",
          );
          videoCards.forEach((card) => {
            const dateText = card.querySelector(
              ".text-gray-500 span:last-child",
            ).textContent;
            const videoDate = new Date(dateText);
            let show = false;
            switch (timeFrame) {
              case "today":
                show = videoDate.toDateString() === today.toDateString();
                break;
              case "week":
                const weekAgo = new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000);
                show = videoDate >= weekAgo;
                break;
              case "month":
                const monthAgo = new Date(
                  today.getFullYear(),
                  today.getMonth() - 1,
                  today.getDate(),
                );
                show = videoDate >= monthAgo;
                break;
            }
            card.style.display = show ? "block" : "none";
          });
        }
        // Initial filter
        filterVideosByTime("today");
      });
    </script>
    <script type="module" src="user.js"></script>
    <script type="module" src="feeds.js"></script>
    <script type="module" src="main.js"></script>
  </body>
</html>
