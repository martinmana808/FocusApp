<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Feed My Brain</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body{font-family:system-ui,sans-serif;max-width:600px;margin:2rem auto}
    #profile{white-space:pre-wrap;background:#f3f3f3;padding:1rem;border-radius:6px}
    button{margin:.4rem .6rem .4rem 0;padding:.4rem .8rem}
  </style>
</head>
<body>
  <h1>Feed My Brain</h1>

  <button id="btn-login">Log in</button>
  <button id="btn-logout" style="display:none">Log out</button>
  <button id="btn-reset" onclick="resetWatched()" class="bg-red-500 text-white">Reset Watched</button>

  <h2 id="hello" style="display:none"></h2>
  <pre id="profile"></pre>

  <div class="flex flex-col md:flex-row gap-4">
    <!-- New Column -->
    <div class="flex-1">
      <button class="md:hidden w-full text-left font-bold text-lg py-2" type="button" onclick="toggleCollapse('new-section')">
        New <span id="badge-new-mobile" class="inline-block bg-blue-500 text-white text-xs rounded-full px-2 ml-2 align-middle"></span>
      </button>
      <div id="new-section" class="collapse-section">
        <h3 class="hidden md:block">New <span id="badge-new" class="inline-block bg-blue-500 text-white text-xs rounded-full px-2 ml-2 align-middle"></span></h3>
        <ul id="new"></ul>
      </div>
    </div>
    <!-- Saved for Later Column -->
    <div class="flex-1">
      <button class="md:hidden w-full text-left font-bold text-lg py-2" type="button" onclick="toggleCollapse('saved-section')">
        Saved for Later <span id="badge-saved-mobile" class="inline-block bg-green-500 text-white text-xs rounded-full px-2 ml-2 align-middle"></span>
      </button>
      <div id="saved-section" class="collapse-section">
        <h3 class="hidden md:block">Saved for Later <span id="badge-saved" class="inline-block bg-green-500 text-white text-xs rounded-full px-2 ml-2 align-middle"></span></h3>
        <ul id="saved"></ul>
      </div>
    </div>
  </div>

  <div id="toast" style="display:none;position:fixed;bottom:32px;left:50%;transform:translateX(-50%);background:#333;color:#fff;padding:12px 24px;border-radius:8px;z-index:1000;min-width:180px;text-align:center;font-size:1rem;box-shadow:0 2px 8px rgba(0,0,0,0.15);opacity:0.95;transition:opacity 0.3s;">
    Toast message
  </div>

  <dialog id="playerModal" class="p-0 rounded-xl shadow-xl">
    <button id="closeModal" class="absolute top-2 right-3 text-xl">âœ•</button>
    <iframe id="playerFrame" width="560" height="315"
            src="" title="YouTube video" allow="autoplay; picture-in-picture"
            allowfullscreen></iframe>
  </dialog>

  <script type="module" src="main.js"></script>
  <script>
    // Collapsible logic for mobile
    function toggleCollapse(id) {
      const el = document.getElementById(id);
      if (el) {
        el.style.display = (el.style.display === 'none' || !el.style.display) ? 'block' : 'none';
      }
    }
    // By default, show both on desktop, only show 'New' on mobile
    function handleResize() {
      if (window.innerWidth < 768) {
        document.getElementById('new-section').style.display = 'block';
        document.getElementById('saved-section').style.display = 'none';
      } else {
        document.getElementById('new-section').style.display = 'block';
        document.getElementById('saved-section').style.display = 'block';
      }
    }
    window.addEventListener('resize', handleResize);
    window.addEventListener('DOMContentLoaded', handleResize);

    // Toast logic
    window.showToast = function(message) {
      const toast = document.getElementById('toast');
      if (!toast) return;
      toast.textContent = message;
      toast.style.display = 'block';
      toast.style.opacity = '0.95';
      setTimeout(() => {
        toast.style.opacity = '0';
        setTimeout(() => { toast.style.display = 'none'; }, 400);
      }, 1800);
    }
  </script>
</body>
</html>

